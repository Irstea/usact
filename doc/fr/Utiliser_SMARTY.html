<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="fr-fr">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <title>Utiliser SMARTY</title>
    <meta content="Eric Quinton" name="author">
    <link rel="stylesheet" href="../../display/CSS/blue.css" type="text/css">
  </head>
  <body>
    <h1>Utiliser SMARTY</h1>
    SMARTY est un moteur de templates, qui permet de séparer le code php de
    l'affichage des pages web.<br>
    Pour utiliser SMARTY dans PrototypePHP, il faut : <br>
    <ul>
      <li>assigner les variables à afficher à SMARTY</li>
      <li>créer un modèle de page (template) qui va contenir les informations à
        afficher</li>
      <li>demander à la classe SMARTY d'afficher la page.</li>
    </ul>
    <h2>Assigner les variables à SMARTY</h2>
    <h3>Cas simple</h3>
    La classe SMARTY est instanciée au démarrage de l'application. Voici
    quelques exemples d'assignation :<br>
    <pre>$smarty-&gt;assign("titre", $titre) ;</pre>
    Assigne la valeur nom à la variable nom.<br>
    <pre>$tableau = array();</pre>
    <pre>$personne = new Personne($bdd);</pre>
    Crée une instance de Personne, en passant en paramètre la connexion ADODB
    (on considère que Personne est un objet hérité de OBJETBDD)<br>
    <pre>$tableau = $personne-&gt;lire($id);</pre>
    <pre>$smarty-&gt;assign("personne", $tableau);</pre>
    Assigne à la variable personne de smarty l'enregistrement de la personne de
    clé $id.<br>
    <p>Et maintenant, l'affichage des variables dans le template smarty (page
      display/templates/test.tpl) :</p>
    <pre>&lt;p&gt;titre : {$titre}&lt;/p&gt;</pre>
    <pre>&lt;p&gt; Affichage du tableau&nbsp;</pre>
    <pre>&lt;br&gt;Prénom : {$personne.prenom}</pre>
    <pre>&lt;br&gt;date de naissance : {$personne.datenaissance}</pre>
    <pre>&lt;/p&gt;</pre>
    <h3>La gestion des boucles</h3>
    <p>Il est possible dans SMARTY de gérer des boucles, notamment pour
      l'affichage de listes dans des tableaux. Voici un exemple tiré de
      l'application display/templates/ident.loginliste.tpl :</p>
    <p>Première étape, dans la page php :</p>
    <pre>$smarty-&gt;assign("liste", $listlogin);</pre>
    <p>Seconde étape, le fichier loginliste.tpl :</p>
    <pre>&lt;table&gt;</pre>
    <pre>&nbsp;&nbsp;&nbsp; &lt;tr&gt;</pre>
    <pre>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;th&gt;{$LANG.login.6}&lt;/td&gt;</pre>
    <pre>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;th&gt;{$LANG.login.7}&lt;/td&gt;</pre>
    <pre>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;th&gt;{$LANG.login.8}&lt;/td&gt;</pre>
    <pre>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;tr&gt;</pre>
    On a affiché le titre de chaque colonne<br>
    <pre>&nbsp;&nbsp;&nbsp; &nbsp;{section name=lst loop=$liste}</pre>
    On boucle sur chaque occurence de liste, la variable lst correspondant au
    niveau d'occurence de la boucle<br>
    <pre>&nbsp;&nbsp;&nbsp; &lt;tr&gt;</pre>
    <pre>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;{$liste[lst].login}&lt;/td&gt;</pre>
    Affichage du login pour chaque occurence lst<br>
    <pre>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;{$liste[lst].nom}&amp;nbsp;{$liste[lst].prenom}&lt;/td&gt;</pre>
    <pre>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;td&gt;{$liste[lst].mail}&amp;nbsp;&lt;/td&gt;</pre>
    <pre>&nbsp;&nbsp;&nbsp; &lt;/tr&gt;</pre>
    <pre>&nbsp;&nbsp;&nbsp; {/section}</pre>
    Fin de la boucle<br>
    <pre>&lt;/table&gt;</pre>
    <h2>Pour aller plus loin...</h2>
    SMARTY dispose d'un langage très riche, on peut faire des tests, gérer de
    façon fine les boucles... Le plus simple, c'est de consulter la
    documentation : <a href="http://www.smarty.net/manual/fr/">http://www.smarty.net/manual/fr/</a>
  </body>
</html>
